letrec gen f x = Cons x (gen f (f x)) in
let numbers = take 1012 (gen (fun x -> (42*x) % 1013) 1) in
letrec qsort xs =
  match xs with
  | Nil -> Nil
  | Cons x xs ->
    match partition (fun y -> y < x) xs with
    | Pair ys zs -> append (qsort ys) (Cons x (qsort zs))
in
let main = print_list (qsort numbers) in
main
